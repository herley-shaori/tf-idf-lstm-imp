Using TensorFlow backend.
WARNING: Logging before flag parsing goes to stderr.
W0618 04:21:25.267292 140435107825472 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:74: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

W0618 04:21:25.274228 140435107825472 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:517: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

W0618 04:21:25.275004 140435107825472 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:4138: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

W0618 04:21:25.284093 140435107825472 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:133: The name tf.placeholder_with_default is deprecated. Please use tf.compat.v1.placeholder_with_default instead.

W0618 04:21:25.287424 140435107825472 deprecation.py:506] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0618 04:21:26.592547 140435107825472 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/optimizers.py:790: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.

W0618 04:21:26.603907 140435107825472 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3295: The name tf.log is deprecated. Please use tf.math.log instead.

W0618 04:21:26.697314 140435107825472 deprecation.py:323] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/tensorflow/python/ops/math_grad.py:1250: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-18 04:21:29.083804: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2020-06-18 04:21:29.105984: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3696000000 Hz
2020-06-18 04:21:29.107164: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x562a35750970 executing computations on platform Host. Devices:
2020-06-18 04:21:29.107179: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): <undefined>, <undefined>
2020-06-18 04:21:29.108109: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcuda.so.1
2020-06-18 04:21:29.124281: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:21:29.124859: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.6325
pciBusID: 0000:01:00.0
2020-06-18 04:21:29.125007: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-06-18 04:21:29.125959: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
2020-06-18 04:21:29.126918: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcufft.so.10
2020-06-18 04:21:29.127094: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcurand.so.10
2020-06-18 04:21:29.128122: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusolver.so.10
2020-06-18 04:21:29.128627: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusparse.so.10
2020-06-18 04:21:29.130814: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7
2020-06-18 04:21:29.130911: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:21:29.131498: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:21:29.132034: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0
2020-06-18 04:21:29.132073: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-06-18 04:21:29.228985: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-06-18 04:21:29.229013: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1187]      0 
2020-06-18 04:21:29.229019: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 0:   N 
2020-06-18 04:21:29.229310: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:21:29.229876: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:21:29.230382: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:21:29.230830: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10388 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)
2020-06-18 04:21:29.231791: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x562a3d0a6ad0 executing computations on platform CUDA. Devices:
2020-06-18 04:21:29.231803: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): GeForce GTX 1080 Ti, Compute Capability 6.1
2020-06-18 04:21:32.093573: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
>>>OBESITY<<<
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, 150, 128)          64000     
_________________________________________________________________
spatial_dropout1d_1 (Spatial (None, 150, 128)          0         
_________________________________________________________________
lstm_1 (LSTM)                (None, 150, 500)          1258000   
_________________________________________________________________
lstm_2 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_3 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_4 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_5 (LSTM)                (None, 500)               2002000   
_________________________________________________________________
dense_1 (Dense)              (None, 4)                 2004      
=================================================================
Total params: 9,332,004
Trainable params: 9,332,004
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/50
 - 9s - loss: 1.2539 - acc: 0.2507
Epoch 2/50
 - 4s - loss: 1.2208 - acc: 0.6403
Epoch 3/50
 - 4s - loss: 0.9263 - acc: 0.6403
Epoch 4/50
 - 3s - loss: 1.6287 - acc: 0.6403
Epoch 5/50
 - 4s - loss: 0.5674 - acc: 0.6403
Epoch 6/50
 - 4s - loss: 1.0231 - acc: 0.3597
Epoch 7/50
 - 4s - loss: 0.6972 - acc: 0.6015
Epoch 8/50
 - 4s - loss: 0.6607 - acc: 0.6403
Epoch 9/50
 - 4s - loss: 0.5935 - acc: 0.6403
Epoch 10/50
 - 4s - loss: 0.6164 - acc: 0.6403
Epoch 11/50
 - 4s - loss: 0.6411 - acc: 0.6403
Epoch 12/50
 - 4s - loss: 0.6291 - acc: 0.6403
Epoch 13/50
 - 4s - loss: 0.5902 - acc: 0.6403
Epoch 14/50
 - 4s - loss: 0.5674 - acc: 0.6403
Epoch 15/50
 - 4s - loss: 0.5699 - acc: 0.6403
Epoch 16/50
 - 4s - loss: 0.5883 - acc: 0.6403
Epoch 17/50
 - 4s - loss: 0.6011 - acc: 0.6403
/home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/callbacks.py:434: RuntimeWarning: Can save best model only with val_loss available, skipping.
  'skipping.' % (self.monitor), RuntimeWarning)
Using TensorFlow backend.
Akurasi:  0.5714285714285714
Using TensorFlow backend.
WARNING: Logging before flag parsing goes to stderr.
W0618 04:22:44.001461 140343973541696 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:74: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

W0618 04:22:44.008379 140343973541696 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:517: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

W0618 04:22:44.009124 140343973541696 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:4138: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

W0618 04:22:44.018045 140343973541696 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:133: The name tf.placeholder_with_default is deprecated. Please use tf.compat.v1.placeholder_with_default instead.

W0618 04:22:44.021371 140343973541696 deprecation.py:506] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0618 04:22:45.327461 140343973541696 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/optimizers.py:790: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.

W0618 04:22:45.339062 140343973541696 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3295: The name tf.log is deprecated. Please use tf.math.log instead.

W0618 04:22:45.433534 140343973541696 deprecation.py:323] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/tensorflow/python/ops/math_grad.py:1250: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-18 04:22:47.819240: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2020-06-18 04:22:47.841922: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3696000000 Hz
2020-06-18 04:22:47.842733: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x558e844cb810 executing computations on platform Host. Devices:
2020-06-18 04:22:47.842765: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): <undefined>, <undefined>
2020-06-18 04:22:47.843404: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcuda.so.1
2020-06-18 04:22:47.859349: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:22:47.859995: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.6325
pciBusID: 0000:01:00.0
2020-06-18 04:22:47.860117: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-06-18 04:22:47.861069: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
2020-06-18 04:22:47.862035: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcufft.so.10
2020-06-18 04:22:47.862181: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcurand.so.10
2020-06-18 04:22:47.863156: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusolver.so.10
2020-06-18 04:22:47.863625: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusparse.so.10
2020-06-18 04:22:47.865707: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7
2020-06-18 04:22:47.865789: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:22:47.866527: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:22:47.866989: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0
2020-06-18 04:22:47.867012: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-06-18 04:22:47.919904: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-06-18 04:22:47.919929: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1187]      0 
2020-06-18 04:22:47.919935: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 0:   N 
2020-06-18 04:22:47.920221: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:22:47.920663: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:22:47.921090: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:22:47.921505: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10388 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)
2020-06-18 04:22:47.922491: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x558e87f9c8c0 executing computations on platform CUDA. Devices:
2020-06-18 04:22:47.922503: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): GeForce GTX 1080 Ti, Compute Capability 6.1
2020-06-18 04:22:50.748056: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
>>>DIABETES MELLITUS<<<
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, 150, 128)          64000     
_________________________________________________________________
spatial_dropout1d_1 (Spatial (None, 150, 128)          0         
_________________________________________________________________
lstm_1 (LSTM)                (None, 150, 500)          1258000   
_________________________________________________________________
lstm_2 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_3 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_4 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_5 (LSTM)                (None, 500)               2002000   
_________________________________________________________________
dense_1 (Dense)              (None, 4)                 2004      
=================================================================
Total params: 9,332,004
Trainable params: 9,332,004
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/50
 - 9s - loss: 1.3198 - acc: 0.3045
Epoch 2/50
 - 3s - loss: 1.2669 - acc: 0.8313
Epoch 3/50
 - 4s - loss: 0.7546 - acc: 0.8313
Epoch 4/50
 - 3s - loss: 1.1997 - acc: 0.8313
Epoch 5/50
 - 4s - loss: 0.7050 - acc: 0.8313
Epoch 6/50
 - 4s - loss: 0.3854 - acc: 0.8313
Epoch 7/50
 - 4s - loss: 0.5195 - acc: 0.8313
Epoch 8/50
 - 3s - loss: 0.3634 - acc: 0.8313
Epoch 9/50
 - 4s - loss: 0.3869 - acc: 0.8313
Epoch 10/50
 - 3s - loss: 0.4091 - acc: 0.8313
Epoch 11/50
 - 3s - loss: 0.3982 - acc: 0.8313
Epoch 12/50
 - 3s - loss: 0.3721 - acc: 0.8313
Epoch 13/50
 - 4s - loss: 1.0084 - acc: 0.7657
Epoch 14/50
 - 4s - loss: 0.3638 - acc: 0.8313
Epoch 15/50
 - 3s - loss: 0.3650 - acc: 0.8313
Epoch 16/50
 - 4s - loss: 0.3656 - acc: 0.8313
Epoch 17/50
 - 3s - loss: 0.3644 - acc: 0.8313
/home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/callbacks.py:434: RuntimeWarning: Can save best model only with val_loss available, skipping.
  'skipping.' % (self.monitor), RuntimeWarning)
Using TensorFlow backend.
Akurasi:  0.8690476190476191
Using TensorFlow backend.
WARNING: Logging before flag parsing goes to stderr.
W0618 04:24:02.027741 139689914308416 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:74: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

W0618 04:24:02.034530 139689914308416 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:517: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

W0618 04:24:02.035302 139689914308416 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:4138: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

W0618 04:24:02.044301 139689914308416 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:133: The name tf.placeholder_with_default is deprecated. Please use tf.compat.v1.placeholder_with_default instead.

W0618 04:24:02.047609 139689914308416 deprecation.py:506] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0618 04:24:03.376996 139689914308416 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/optimizers.py:790: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.

W0618 04:24:03.388336 139689914308416 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3295: The name tf.log is deprecated. Please use tf.math.log instead.

W0618 04:24:03.483895 139689914308416 deprecation.py:323] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/tensorflow/python/ops/math_grad.py:1250: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-18 04:24:05.920374: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2020-06-18 04:24:05.941925: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3696000000 Hz
2020-06-18 04:24:05.943049: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55655dcf0e80 executing computations on platform Host. Devices:
2020-06-18 04:24:05.943081: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): <undefined>, <undefined>
2020-06-18 04:24:05.943670: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcuda.so.1
2020-06-18 04:24:05.959452: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:24:05.960176: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.6325
pciBusID: 0000:01:00.0
2020-06-18 04:24:05.960294: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-06-18 04:24:05.961379: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
2020-06-18 04:24:05.962439: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcufft.so.10
2020-06-18 04:24:05.962592: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcurand.so.10
2020-06-18 04:24:05.963742: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusolver.so.10
2020-06-18 04:24:05.964364: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusparse.so.10
2020-06-18 04:24:05.966891: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7
2020-06-18 04:24:05.966971: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:24:05.967721: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:24:05.968186: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0
2020-06-18 04:24:05.968209: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-06-18 04:24:06.023484: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-06-18 04:24:06.023509: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1187]      0 
2020-06-18 04:24:06.023515: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 0:   N 
2020-06-18 04:24:06.023809: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:24:06.024751: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:24:06.025181: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:24:06.025596: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10388 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)
2020-06-18 04:24:06.026629: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55656563d820 executing computations on platform CUDA. Devices:
2020-06-18 04:24:06.026642: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): GeForce GTX 1080 Ti, Compute Capability 6.1
2020-06-18 04:24:08.863260: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
>>>Hypercholestrolemia<<<
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, 150, 128)          64000     
_________________________________________________________________
spatial_dropout1d_1 (Spatial (None, 150, 128)          0         
_________________________________________________________________
lstm_1 (LSTM)                (None, 150, 500)          1258000   
_________________________________________________________________
lstm_2 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_3 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_4 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_5 (LSTM)                (None, 500)               2002000   
_________________________________________________________________
dense_1 (Dense)              (None, 4)                 2004      
=================================================================
Total params: 9,332,004
Trainable params: 9,332,004
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/50
 - 9s - loss: 1.2477 - acc: 0.2657
Epoch 2/50
 - 4s - loss: 1.2129 - acc: 0.7851
Epoch 3/50
 - 4s - loss: 0.8983 - acc: 0.7851
Epoch 4/50
 - 4s - loss: 1.3863 - acc: 0.7851
Epoch 5/50
 - 4s - loss: 0.5087 - acc: 0.7851
Epoch 6/50
 - 4s - loss: 1.2974 - acc: 0.2149
Epoch 7/50
 - 4s - loss: 0.6291 - acc: 0.7343
Epoch 8/50
 - 4s - loss: 0.5626 - acc: 0.7851
Epoch 9/50
 - 4s - loss: 0.5243 - acc: 0.7851
Epoch 10/50
 - 4s - loss: 0.5587 - acc: 0.7851
Epoch 11/50
 - 4s - loss: 0.5947 - acc: 0.7851
Epoch 12/50
 - 4s - loss: 0.5925 - acc: 0.7851
Epoch 13/50
 - 4s - loss: 0.5632 - acc: 0.7851
Epoch 14/50
 - 4s - loss: 0.5298 - acc: 0.7851
Epoch 15/50
 - 4s - loss: 0.5054 - acc: 0.7851
Epoch 16/50
 - 4s - loss: 0.5009 - acc: 0.7851
Epoch 17/50
 - 4s - loss: 0.5084 - acc: 0.7851
/home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/callbacks.py:434: RuntimeWarning: Can save best model only with val_loss available, skipping.
  'skipping.' % (self.monitor), RuntimeWarning)
Using TensorFlow backend.
Akurasi:  0.6607142857142857
Using TensorFlow backend.
WARNING: Logging before flag parsing goes to stderr.
W0618 04:25:21.063522 140419499419456 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:74: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

W0618 04:25:21.070331 140419499419456 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:517: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

W0618 04:25:21.071084 140419499419456 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:4138: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

W0618 04:25:21.080072 140419499419456 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:133: The name tf.placeholder_with_default is deprecated. Please use tf.compat.v1.placeholder_with_default instead.

W0618 04:25:21.083366 140419499419456 deprecation.py:506] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0618 04:25:22.408166 140419499419456 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/optimizers.py:790: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.

W0618 04:25:22.419505 140419499419456 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3295: The name tf.log is deprecated. Please use tf.math.log instead.

W0618 04:25:22.514896 140419499419456 deprecation.py:323] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/tensorflow/python/ops/math_grad.py:1250: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-18 04:25:24.945056: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2020-06-18 04:25:24.965971: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3696000000 Hz
2020-06-18 04:25:24.966897: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55ed43c6b170 executing computations on platform Host. Devices:
2020-06-18 04:25:24.966914: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): <undefined>, <undefined>
2020-06-18 04:25:24.967521: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcuda.so.1
2020-06-18 04:25:24.983475: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:25:24.984141: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.6325
pciBusID: 0000:01:00.0
2020-06-18 04:25:24.984257: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-06-18 04:25:24.985252: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
2020-06-18 04:25:24.986242: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcufft.so.10
2020-06-18 04:25:24.986399: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcurand.so.10
2020-06-18 04:25:24.987436: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusolver.so.10
2020-06-18 04:25:24.987988: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusparse.so.10
2020-06-18 04:25:24.990300: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7
2020-06-18 04:25:24.990381: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:25:24.991057: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:25:24.991744: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0
2020-06-18 04:25:24.991772: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-06-18 04:25:25.051405: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-06-18 04:25:25.051431: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1187]      0 
2020-06-18 04:25:25.051438: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 0:   N 
2020-06-18 04:25:25.051727: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:25:25.052182: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:25:25.052620: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:25:25.053042: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10388 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)
2020-06-18 04:25:25.054055: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55ed4b5c0e50 executing computations on platform CUDA. Devices:
2020-06-18 04:25:25.054069: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): GeForce GTX 1080 Ti, Compute Capability 6.1
2020-06-18 04:25:27.905989: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
>>>Hypertriglyceridemia<<<
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, 150, 128)          64000     
_________________________________________________________________
spatial_dropout1d_1 (Spatial (None, 150, 128)          0         
_________________________________________________________________
lstm_1 (LSTM)                (None, 150, 500)          1258000   
_________________________________________________________________
lstm_2 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_3 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_4 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_5 (LSTM)                (None, 500)               2002000   
_________________________________________________________________
dense_1 (Dense)              (None, 4)                 2004      
=================================================================
Total params: 9,332,004
Trainable params: 9,332,004
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/50
 - 9s - loss: 1.2665 - acc: 0.2373
Epoch 2/50
 - 4s - loss: 1.2396 - acc: 0.5612
Epoch 3/50
 - 4s - loss: 1.0390 - acc: 0.5612
Epoch 4/50
 - 4s - loss: 1.3504 - acc: 0.5612
Epoch 5/50
 - 4s - loss: 0.6850 - acc: 0.3791
Epoch 6/50
 - 4s - loss: 0.7972 - acc: 0.3493
Epoch 7/50
 - 4s - loss: 0.7728 - acc: 0.3493
Epoch 8/50
 - 4s - loss: 0.7115 - acc: 0.3493
Epoch 9/50
 - 4s - loss: 0.6524 - acc: 0.5284
Epoch 10/50
 - 4s - loss: 0.6309 - acc: 0.5612
Epoch 11/50
 - 4s - loss: 0.6523 - acc: 0.5612
Epoch 12/50
 - 4s - loss: 0.6485 - acc: 0.5612
Epoch 13/50
 - 4s - loss: 0.6298 - acc: 0.5612
Epoch 14/50
 - 4s - loss: 0.6540 - acc: 0.4851
Epoch 15/50
 - 4s - loss: 0.6381 - acc: 0.5597
Epoch 16/50
 - 4s - loss: 0.6353 - acc: 0.5612
Epoch 17/50
 - 4s - loss: 0.6460 - acc: 0.5612
/home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/callbacks.py:434: RuntimeWarning: Can save best model only with val_loss available, skipping.
  'skipping.' % (self.monitor), RuntimeWarning)
Using TensorFlow backend.
Akurasi:  0.5416666666666666
Using TensorFlow backend.
WARNING: Logging before flag parsing goes to stderr.
W0618 04:26:39.987857 140133095147328 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:74: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

W0618 04:26:39.994822 140133095147328 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:517: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

W0618 04:26:39.995574 140133095147328 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:4138: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

W0618 04:26:40.004499 140133095147328 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:133: The name tf.placeholder_with_default is deprecated. Please use tf.compat.v1.placeholder_with_default instead.

W0618 04:26:40.007851 140133095147328 deprecation.py:506] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0618 04:26:41.334783 140133095147328 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/optimizers.py:790: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.

W0618 04:26:41.346142 140133095147328 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3295: The name tf.log is deprecated. Please use tf.math.log instead.

W0618 04:26:41.442602 140133095147328 deprecation.py:323] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/tensorflow/python/ops/math_grad.py:1250: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-18 04:26:43.899764: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2020-06-18 04:26:43.922007: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3696000000 Hz
2020-06-18 04:26:43.922854: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55cd80b22cb0 executing computations on platform Host. Devices:
2020-06-18 04:26:43.922869: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): <undefined>, <undefined>
2020-06-18 04:26:43.923491: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcuda.so.1
2020-06-18 04:26:43.939126: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:26:43.939953: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.6325
pciBusID: 0000:01:00.0
2020-06-18 04:26:43.940083: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-06-18 04:26:43.941042: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
2020-06-18 04:26:43.941999: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcufft.so.10
2020-06-18 04:26:43.942144: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcurand.so.10
2020-06-18 04:26:43.943133: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusolver.so.10
2020-06-18 04:26:43.943603: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusparse.so.10
2020-06-18 04:26:43.945736: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7
2020-06-18 04:26:43.945804: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:26:43.946547: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:26:43.947255: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0
2020-06-18 04:26:43.947278: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-06-18 04:26:43.998721: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-06-18 04:26:43.998748: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1187]      0 
2020-06-18 04:26:43.998754: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 0:   N 
2020-06-18 04:26:43.999042: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:26:43.999489: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:26:43.999919: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:26:44.000336: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10388 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)
2020-06-18 04:26:44.001341: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55cd88470670 executing computations on platform CUDA. Devices:
2020-06-18 04:26:44.001353: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): GeForce GTX 1080 Ti, Compute Capability 6.1
2020-06-18 04:26:46.838235: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
>>>Hypertension<<<
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, 150, 128)          64000     
_________________________________________________________________
spatial_dropout1d_1 (Spatial (None, 150, 128)          0         
_________________________________________________________________
lstm_1 (LSTM)                (None, 150, 500)          1258000   
_________________________________________________________________
lstm_2 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_3 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_4 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_5 (LSTM)                (None, 500)               2002000   
_________________________________________________________________
dense_1 (Dense)              (None, 4)                 2004      
=================================================================
Total params: 9,332,004
Trainable params: 9,332,004
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/50
 - 9s - loss: 0.7946 - acc: 0.2358
Epoch 2/50
 - 3s - loss: 0.7785 - acc: 0.3119
Epoch 3/50
 - 3s - loss: 0.6686 - acc: 0.2910
Epoch 4/50
 - 3s - loss: 0.4175 - acc: 0.2910
Epoch 5/50
 - 4s - loss: 1.3177 - acc: 0.2791
Epoch 6/50
 - 4s - loss: 0.4484 - acc: 0.2791
Epoch 7/50
 - 4s - loss: 0.8198 - acc: 0.2925
Epoch 8/50
 - 3s - loss: 0.5808 - acc: 0.2925
Epoch 9/50
 - 3s - loss: 0.4067 - acc: 0.3060
Epoch 10/50
 - 4s - loss: 0.4368 - acc: 0.2791
Epoch 11/50
 - 4s - loss: 0.4514 - acc: 0.2791
Epoch 12/50
 - 4s - loss: 0.4384 - acc: 0.2791
Epoch 13/50
 - 4s - loss: 0.4199 - acc: 0.2791
Epoch 14/50
 - 4s - loss: 0.4105 - acc: 0.2955
Epoch 15/50
 - 3s - loss: 0.4107 - acc: 0.2925
Epoch 16/50
 - 4s - loss: 0.4184 - acc: 0.2925
Epoch 17/50
 - 3s - loss: 0.4203 - acc: 0.2925
/home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/callbacks.py:434: RuntimeWarning: Can save best model only with val_loss available, skipping.
  'skipping.' % (self.monitor), RuntimeWarning)
Using TensorFlow backend.
Akurasi:  0.27380952380952384
Using TensorFlow backend.
WARNING: Logging before flag parsing goes to stderr.
W0618 04:27:58.286869 140252184688448 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:74: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

W0618 04:27:58.293844 140252184688448 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:517: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

W0618 04:27:58.294620 140252184688448 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:4138: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

W0618 04:27:58.303615 140252184688448 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:133: The name tf.placeholder_with_default is deprecated. Please use tf.compat.v1.placeholder_with_default instead.

W0618 04:27:58.307008 140252184688448 deprecation.py:506] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0618 04:27:59.623335 140252184688448 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/optimizers.py:790: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.

W0618 04:27:59.634431 140252184688448 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3295: The name tf.log is deprecated. Please use tf.math.log instead.

W0618 04:27:59.728401 140252184688448 deprecation.py:323] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/tensorflow/python/ops/math_grad.py:1250: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-18 04:28:02.127535: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2020-06-18 04:28:02.149960: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3696000000 Hz
2020-06-18 04:28:02.151248: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55832198b3b0 executing computations on platform Host. Devices:
2020-06-18 04:28:02.151287: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): <undefined>, <undefined>
2020-06-18 04:28:02.152411: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcuda.so.1
2020-06-18 04:28:02.169309: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:28:02.170049: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.6325
pciBusID: 0000:01:00.0
2020-06-18 04:28:02.170171: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-06-18 04:28:02.171243: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
2020-06-18 04:28:02.172256: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcufft.so.10
2020-06-18 04:28:02.172408: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcurand.so.10
2020-06-18 04:28:02.173536: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusolver.so.10
2020-06-18 04:28:02.174192: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusparse.so.10
2020-06-18 04:28:02.176602: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7
2020-06-18 04:28:02.176677: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:28:02.177428: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:28:02.178172: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0
2020-06-18 04:28:02.178199: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-06-18 04:28:02.231184: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-06-18 04:28:02.231209: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1187]      0 
2020-06-18 04:28:02.231215: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 0:   N 
2020-06-18 04:28:02.231500: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:28:02.231952: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:28:02.232380: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:28:02.232796: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10388 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)
2020-06-18 04:28:02.233789: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5583292e12c0 executing computations on platform CUDA. Devices:
2020-06-18 04:28:02.233803: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): GeForce GTX 1080 Ti, Compute Capability 6.1
2020-06-18 04:28:05.078473: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
>>>Atherosclerotic CV<<<
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, 150, 128)          64000     
_________________________________________________________________
spatial_dropout1d_1 (Spatial (None, 150, 128)          0         
_________________________________________________________________
lstm_1 (LSTM)                (None, 150, 500)          1258000   
_________________________________________________________________
lstm_2 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_3 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_4 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_5 (LSTM)                (None, 500)               2002000   
_________________________________________________________________
dense_1 (Dense)              (None, 4)                 2004      
=================================================================
Total params: 9,332,004
Trainable params: 9,332,004
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/50
 - 9s - loss: 1.3056 - acc: 0.2358
Epoch 2/50
 - 4s - loss: 1.2597 - acc: 0.8119
Epoch 3/50
 - 4s - loss: 0.8043 - acc: 0.8119
Epoch 4/50
 - 4s - loss: 1.2365 - acc: 0.8119
Epoch 5/50
 - 4s - loss: 0.6896 - acc: 0.8119
Epoch 6/50
 - 4s - loss: 0.4498 - acc: 0.8119
Epoch 7/50
 - 4s - loss: 0.4431 - acc: 0.8119
Epoch 8/50
 - 4s - loss: 0.3782 - acc: 0.8119
Epoch 9/50
 - 4s - loss: 0.3947 - acc: 0.8119
Epoch 10/50
 - 4s - loss: 0.4064 - acc: 0.8119
Epoch 11/50
 - 4s - loss: 0.3948 - acc: 0.8119
Epoch 12/50
 - 4s - loss: 0.3819 - acc: 0.8119
Epoch 13/50
 - 4s - loss: 0.3825 - acc: 0.8119
Epoch 14/50
 - 4s - loss: 0.3884 - acc: 0.8119
Epoch 15/50
 - 4s - loss: 0.3854 - acc: 0.8119
Epoch 16/50
 - 4s - loss: 0.3810 - acc: 0.8119
Epoch 17/50
 - 3s - loss: 0.3785 - acc: 0.8119
/home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/callbacks.py:434: RuntimeWarning: Can save best model only with val_loss available, skipping.
  'skipping.' % (self.monitor), RuntimeWarning)
Using TensorFlow backend.
Akurasi:  0.8035714285714286
Using TensorFlow backend.
WARNING: Logging before flag parsing goes to stderr.
W0618 04:29:17.421975 139641827460928 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:74: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

W0618 04:29:17.428845 139641827460928 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:517: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

W0618 04:29:17.429613 139641827460928 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:4138: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

W0618 04:29:17.438588 139641827460928 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:133: The name tf.placeholder_with_default is deprecated. Please use tf.compat.v1.placeholder_with_default instead.

W0618 04:29:17.441964 139641827460928 deprecation.py:506] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0618 04:29:18.777338 139641827460928 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/optimizers.py:790: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.

W0618 04:29:18.788606 139641827460928 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3295: The name tf.log is deprecated. Please use tf.math.log instead.

W0618 04:29:18.884667 139641827460928 deprecation.py:323] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/tensorflow/python/ops/math_grad.py:1250: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-18 04:29:21.323552: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2020-06-18 04:29:21.345944: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3696000000 Hz
2020-06-18 04:29:21.346902: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5585b3385e60 executing computations on platform Host. Devices:
2020-06-18 04:29:21.346916: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): <undefined>, <undefined>
2020-06-18 04:29:21.347545: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcuda.so.1
2020-06-18 04:29:21.363687: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:29:21.364447: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.6325
pciBusID: 0000:01:00.0
2020-06-18 04:29:21.364595: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-06-18 04:29:21.365632: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
2020-06-18 04:29:21.366664: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcufft.so.10
2020-06-18 04:29:21.366845: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcurand.so.10
2020-06-18 04:29:21.367924: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusolver.so.10
2020-06-18 04:29:21.368508: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusparse.so.10
2020-06-18 04:29:21.370810: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7
2020-06-18 04:29:21.370915: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:29:21.371699: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:29:21.372418: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0
2020-06-18 04:29:21.372458: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-06-18 04:29:21.424493: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-06-18 04:29:21.424518: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1187]      0 
2020-06-18 04:29:21.424524: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 0:   N 
2020-06-18 04:29:21.424809: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:29:21.425255: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:29:21.425749: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:29:21.426168: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10388 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)
2020-06-18 04:29:21.427208: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5585bad01280 executing computations on platform CUDA. Devices:
2020-06-18 04:29:21.427221: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): GeForce GTX 1080 Ti, Compute Capability 6.1
2020-06-18 04:29:24.294997: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
>>>Heart Failure<<<
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, 150, 128)          64000     
_________________________________________________________________
spatial_dropout1d_1 (Spatial (None, 150, 128)          0         
_________________________________________________________________
lstm_1 (LSTM)                (None, 150, 500)          1258000   
_________________________________________________________________
lstm_2 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_3 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_4 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_5 (LSTM)                (None, 500)               2002000   
_________________________________________________________________
dense_1 (Dense)              (None, 4)                 2004      
=================================================================
Total params: 9,332,004
Trainable params: 9,332,004
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/50
 - 9s - loss: 1.1940 - acc: 0.2284
Epoch 2/50
 - 4s - loss: 1.1641 - acc: 0.6119
Epoch 3/50
 - 4s - loss: 0.9184 - acc: 0.6119
Epoch 4/50
 - 3s - loss: 1.5883 - acc: 0.6119
Epoch 5/50
 - 4s - loss: 0.5416 - acc: 0.6119
Epoch 6/50
 - 4s - loss: 0.7315 - acc: 0.2493
Epoch 7/50
 - 4s - loss: 0.6762 - acc: 0.2701
Epoch 8/50
 - 4s - loss: 0.5905 - acc: 0.6119
Epoch 9/50
 - 4s - loss: 0.5304 - acc: 0.6119
Epoch 10/50
 - 4s - loss: 0.5346 - acc: 0.6119
Epoch 11/50
 - 4s - loss: 0.5439 - acc: 0.6119
Epoch 12/50
 - 4s - loss: 0.5227 - acc: 0.6119
Epoch 13/50
 - 4s - loss: 0.5305 - acc: 0.6119
Epoch 14/50
 - 4s - loss: 0.5341 - acc: 0.6119
Epoch 15/50
 - 4s - loss: 0.5197 - acc: 0.6119
Epoch 16/50
 - 4s - loss: 0.5267 - acc: 0.6119
Epoch 17/50
 - 4s - loss: 0.5313 - acc: 0.6119
/home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/callbacks.py:434: RuntimeWarning: Can save best model only with val_loss available, skipping.
  'skipping.' % (self.monitor), RuntimeWarning)
Using TensorFlow backend.
Akurasi:  0.6071428571428571
Using TensorFlow backend.
WARNING: Logging before flag parsing goes to stderr.
W0618 04:30:36.369335 139749496973120 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:74: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

W0618 04:30:36.376218 139749496973120 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:517: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

W0618 04:30:36.376962 139749496973120 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:4138: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

W0618 04:30:36.385761 139749496973120 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:133: The name tf.placeholder_with_default is deprecated. Please use tf.compat.v1.placeholder_with_default instead.

W0618 04:30:36.388981 139749496973120 deprecation.py:506] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0618 04:30:37.713047 139749496973120 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/optimizers.py:790: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.

W0618 04:30:37.723999 139749496973120 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3295: The name tf.log is deprecated. Please use tf.math.log instead.

W0618 04:30:37.817637 139749496973120 deprecation.py:323] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/tensorflow/python/ops/math_grad.py:1250: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-18 04:30:40.188660: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2020-06-18 04:30:40.209977: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3696000000 Hz
2020-06-18 04:30:40.210704: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5595a2ac3dd0 executing computations on platform Host. Devices:
2020-06-18 04:30:40.210756: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): <undefined>, <undefined>
2020-06-18 04:30:40.211433: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcuda.so.1
2020-06-18 04:30:40.226894: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:30:40.227646: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.6325
pciBusID: 0000:01:00.0
2020-06-18 04:30:40.227789: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-06-18 04:30:40.228689: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
2020-06-18 04:30:40.229683: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcufft.so.10
2020-06-18 04:30:40.229867: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcurand.so.10
2020-06-18 04:30:40.230765: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusolver.so.10
2020-06-18 04:30:40.231190: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusparse.so.10
2020-06-18 04:30:40.233046: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7
2020-06-18 04:30:40.233139: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:30:40.233949: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:30:40.234662: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0
2020-06-18 04:30:40.234701: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-06-18 04:30:40.285320: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-06-18 04:30:40.285346: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1187]      0 
2020-06-18 04:30:40.285352: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 0:   N 
2020-06-18 04:30:40.285634: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:30:40.286089: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:30:40.286521: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:30:40.286936: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10388 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)
2020-06-18 04:30:40.287941: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5595a388b910 executing computations on platform CUDA. Devices:
2020-06-18 04:30:40.287954: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): GeForce GTX 1080 Ti, Compute Capability 6.1
2020-06-18 04:30:43.133685: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
>>>PVD<<<
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, 150, 128)          64000     
_________________________________________________________________
spatial_dropout1d_1 (Spatial (None, 150, 128)          0         
_________________________________________________________________
lstm_1 (LSTM)                (None, 150, 500)          1258000   
_________________________________________________________________
lstm_2 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_3 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_4 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_5 (LSTM)                (None, 500)               2002000   
_________________________________________________________________
dense_1 (Dense)              (None, 4)                 2004      
=================================================================
Total params: 9,332,004
Trainable params: 9,332,004
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/50
 - 9s - loss: 1.2558 - acc: 0.2836
Epoch 2/50
 - 4s - loss: 1.2248 - acc: 0.5030
Epoch 3/50
 - 4s - loss: 0.9707 - acc: 0.5030
Epoch 4/50
 - 3s - loss: 1.2102 - acc: 0.5030
Epoch 5/50
 - 4s - loss: 1.2095 - acc: 0.4030
Epoch 6/50
 - 4s - loss: 0.7161 - acc: 0.4030
Epoch 7/50
 - 4s - loss: 0.6880 - acc: 0.5030
Epoch 8/50
 - 4s - loss: 0.6715 - acc: 0.5030
Epoch 9/50
 - 3s - loss: 0.6865 - acc: 0.5030
Epoch 10/50
 - 3s - loss: 0.6837 - acc: 0.5030
Epoch 11/50
 - 4s - loss: 0.6475 - acc: 0.5030
Epoch 12/50
 - 4s - loss: 0.6235 - acc: 0.5030
Epoch 13/50
 - 4s - loss: 0.6337 - acc: 0.4104
Epoch 14/50
 - 4s - loss: 0.6541 - acc: 0.4030
Epoch 15/50
 - 4s - loss: 0.6512 - acc: 0.4030
Epoch 16/50
 - 3s - loss: 0.6353 - acc: 0.4104
Epoch 17/50
 - 3s - loss: 0.6249 - acc: 0.5045
Epoch 18/50
 - 3s - loss: 0.6271 - acc: 0.5030
Epoch 19/50
 - 4s - loss: 0.6354 - acc: 0.5030
Epoch 20/50
 - 4s - loss: 0.6392 - acc: 0.5030
Epoch 21/50
 - 4s - loss: 0.6359 - acc: 0.5030
Epoch 22/50
 - 3s - loss: 0.6281 - acc: 0.5030
Epoch 23/50
 - 4s - loss: 0.6237 - acc: 0.5030
Epoch 24/50
 - 4s - loss: 0.6251 - acc: 0.5090
Epoch 25/50
 - 4s - loss: 0.6284 - acc: 0.4582
Epoch 26/50
 - 4s - loss: 0.6310 - acc: 0.4239
Epoch 27/50
 - 4s - loss: 0.6301 - acc: 0.4164
Epoch 28/50
 - 4s - loss: 0.6252 - acc: 0.5000
Epoch 29/50
 - 4s - loss: 0.6209 - acc: 0.5030
Epoch 30/50
 - 4s - loss: 0.6244 - acc: 0.5030
Epoch 31/50
 - 4s - loss: 0.6271 - acc: 0.5030
Epoch 32/50
 - 4s - loss: 0.6271 - acc: 0.5030
Epoch 33/50
 - 4s - loss: 0.6273 - acc: 0.5030
Epoch 34/50
 - 4s - loss: 0.6238 - acc: 0.5030
Epoch 35/50
 - 4s - loss: 0.6224 - acc: 0.5030
Epoch 36/50
 - 3s - loss: 0.6228 - acc: 0.5030
Epoch 37/50
 - 4s - loss: 0.6247 - acc: 0.4955
Epoch 38/50
 - 4s - loss: 0.6253 - acc: 0.5000
Epoch 39/50
 - 4s - loss: 0.6250 - acc: 0.5045
/home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/callbacks.py:434: RuntimeWarning: Can save best model only with val_loss available, skipping.
  'skipping.' % (self.monitor), RuntimeWarning)
Using TensorFlow backend.
Akurasi:  0.4642857142857143
Using TensorFlow backend.
WARNING: Logging before flag parsing goes to stderr.
W0618 04:33:12.345187 140187303987008 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:74: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

W0618 04:33:12.352096 140187303987008 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:517: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

W0618 04:33:12.352855 140187303987008 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:4138: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

W0618 04:33:12.361774 140187303987008 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:133: The name tf.placeholder_with_default is deprecated. Please use tf.compat.v1.placeholder_with_default instead.

W0618 04:33:12.365003 140187303987008 deprecation.py:506] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0618 04:33:13.699616 140187303987008 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/optimizers.py:790: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.

W0618 04:33:13.710807 140187303987008 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3295: The name tf.log is deprecated. Please use tf.math.log instead.

W0618 04:33:13.805798 140187303987008 deprecation.py:323] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/tensorflow/python/ops/math_grad.py:1250: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-18 04:33:16.219396: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2020-06-18 04:33:16.241912: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3696000000 Hz
2020-06-18 04:33:16.242764: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559dbe68f170 executing computations on platform Host. Devices:
2020-06-18 04:33:16.242813: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): <undefined>, <undefined>
2020-06-18 04:33:16.243574: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcuda.so.1
2020-06-18 04:33:16.258937: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:33:16.259660: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.6325
pciBusID: 0000:01:00.0
2020-06-18 04:33:16.259775: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-06-18 04:33:16.260654: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
2020-06-18 04:33:16.261527: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcufft.so.10
2020-06-18 04:33:16.261691: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcurand.so.10
2020-06-18 04:33:16.262590: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusolver.so.10
2020-06-18 04:33:16.262986: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusparse.so.10
2020-06-18 04:33:16.264871: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7
2020-06-18 04:33:16.265011: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:33:16.265829: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:33:16.266522: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0
2020-06-18 04:33:16.266545: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-06-18 04:33:16.318167: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-06-18 04:33:16.318194: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1187]      0 
2020-06-18 04:33:16.318199: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 0:   N 
2020-06-18 04:33:16.318481: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:33:16.318925: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:33:16.319352: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:33:16.319765: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10388 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)
2020-06-18 04:33:16.320699: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559dc5fe6040 executing computations on platform CUDA. Devices:
2020-06-18 04:33:16.320712: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): GeForce GTX 1080 Ti, Compute Capability 6.1
2020-06-18 04:33:19.172125: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
>>>Venous Insufficiency<<<
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, 150, 128)          64000     
_________________________________________________________________
spatial_dropout1d_1 (Spatial (None, 150, 128)          0         
_________________________________________________________________
lstm_1 (LSTM)                (None, 150, 500)          1258000   
_________________________________________________________________
lstm_2 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_3 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_4 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_5 (LSTM)                (None, 500)               2002000   
_________________________________________________________________
dense_1 (Dense)              (None, 4)                 2004      
=================================================================
Total params: 9,332,004
Trainable params: 9,332,004
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/50
 - 9s - loss: 0.9310 - acc: 0.2552
Epoch 2/50
 - 4s - loss: 0.8993 - acc: 0.5776
Epoch 3/50
 - 4s - loss: 0.6100 - acc: 0.5776
Epoch 4/50
 - 4s - loss: 0.8152 - acc: 0.5776
Epoch 5/50
 - 4s - loss: 0.4492 - acc: 0.5776
Epoch 6/50
 - 4s - loss: 0.3288 - acc: 0.5776
Epoch 7/50
 - 4s - loss: 0.3370 - acc: 0.5776
Epoch 8/50
 - 4s - loss: 0.2869 - acc: 0.5776
Epoch 9/50
 - 4s - loss: 0.2843 - acc: 0.5776
Epoch 10/50
 - 4s - loss: 0.2931 - acc: 0.5776
Epoch 11/50
 - 4s - loss: 0.2970 - acc: 0.5776
Epoch 12/50
 - 4s - loss: 0.2944 - acc: 0.5776
Epoch 13/50
 - 4s - loss: 0.2879 - acc: 0.5776
Epoch 14/50
 - 4s - loss: 0.2847 - acc: 0.5776
Epoch 15/50
 - 3s - loss: 0.2852 - acc: 0.5776
Epoch 16/50
 - 4s - loss: 0.2833 - acc: 0.5776
Epoch 17/50
 - 4s - loss: 0.2841 - acc: 0.5776
/home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/callbacks.py:434: RuntimeWarning: Can save best model only with val_loss available, skipping.
  'skipping.' % (self.monitor), RuntimeWarning)
Using TensorFlow backend.
Akurasi:  0.5535714285714286
Using TensorFlow backend.
WARNING: Logging before flag parsing goes to stderr.
W0618 04:34:31.481025 140328516310848 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:74: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

W0618 04:34:31.487837 140328516310848 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:517: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

W0618 04:34:31.488605 140328516310848 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:4138: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

W0618 04:34:31.497617 140328516310848 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:133: The name tf.placeholder_with_default is deprecated. Please use tf.compat.v1.placeholder_with_default instead.

W0618 04:34:31.500925 140328516310848 deprecation.py:506] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0618 04:34:32.827043 140328516310848 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/optimizers.py:790: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.

W0618 04:34:32.838180 140328516310848 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3295: The name tf.log is deprecated. Please use tf.math.log instead.

W0618 04:34:32.932888 140328516310848 deprecation.py:323] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/tensorflow/python/ops/math_grad.py:1250: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-18 04:34:35.313116: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2020-06-18 04:34:35.333933: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3696000000 Hz
2020-06-18 04:34:35.335097: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56400a1d8650 executing computations on platform Host. Devices:
2020-06-18 04:34:35.335130: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): <undefined>, <undefined>
2020-06-18 04:34:35.335756: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcuda.so.1
2020-06-18 04:34:35.351922: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:34:35.352572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.6325
pciBusID: 0000:01:00.0
2020-06-18 04:34:35.352729: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-06-18 04:34:35.353831: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
2020-06-18 04:34:35.354838: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcufft.so.10
2020-06-18 04:34:35.355020: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcurand.so.10
2020-06-18 04:34:35.356115: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusolver.so.10
2020-06-18 04:34:35.356693: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusparse.so.10
2020-06-18 04:34:35.359249: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7
2020-06-18 04:34:35.359359: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:34:35.360161: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:34:35.360894: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0
2020-06-18 04:34:35.360933: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-06-18 04:34:35.413592: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-06-18 04:34:35.413618: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1187]      0 
2020-06-18 04:34:35.413639: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 0:   N 
2020-06-18 04:34:35.413981: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:34:35.414540: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:34:35.414990: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:34:35.415427: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10388 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)
2020-06-18 04:34:35.416457: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x564011b26350 executing computations on platform CUDA. Devices:
2020-06-18 04:34:35.416468: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): GeForce GTX 1080 Ti, Compute Capability 6.1
2020-06-18 04:34:38.272397: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
>>>Osteoarthritis<<<
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, 150, 128)          64000     
_________________________________________________________________
spatial_dropout1d_1 (Spatial (None, 150, 128)          0         
_________________________________________________________________
lstm_1 (LSTM)                (None, 150, 500)          1258000   
_________________________________________________________________
lstm_2 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_3 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_4 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_5 (LSTM)                (None, 500)               2002000   
_________________________________________________________________
dense_1 (Dense)              (None, 4)                 2004      
=================================================================
Total params: 9,332,004
Trainable params: 9,332,004
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/50
 - 9s - loss: 1.4132 - acc: 0.2582
Epoch 2/50
 - 4s - loss: 1.3619 - acc: 0.9687
Epoch 3/50
 - 4s - loss: 0.8661 - acc: 0.9687
Epoch 4/50
 - 4s - loss: 1.6323 - acc: 0.9687
Epoch 5/50
 - 4s - loss: 0.9317 - acc: 0.9687
Epoch 6/50
 - 4s - loss: 0.4620 - acc: 0.9687
Epoch 7/50
 - 4s - loss: 0.7243 - acc: 0.6373
Epoch 8/50
 - 4s - loss: 0.5055 - acc: 0.9687
Epoch 9/50
 - 4s - loss: 0.4680 - acc: 0.9687
Epoch 10/50
 - 4s - loss: 0.4810 - acc: 0.9687
Epoch 11/50
 - 4s - loss: 0.5050 - acc: 0.9687
Epoch 12/50
 - 4s - loss: 0.5060 - acc: 0.9687
Epoch 13/50
 - 4s - loss: 0.4959 - acc: 0.9687
Epoch 14/50
 - 4s - loss: 0.4767 - acc: 0.9687
Epoch 15/50
 - 4s - loss: 0.4606 - acc: 0.9687
Epoch 16/50
 - 4s - loss: 0.4584 - acc: 0.9687
Epoch 17/50
 - 4s - loss: 0.4629 - acc: 0.9687
/home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/callbacks.py:434: RuntimeWarning: Can save best model only with val_loss available, skipping.
  'skipping.' % (self.monitor), RuntimeWarning)
Using TensorFlow backend.
Akurasi:  0.7619047619047619
Using TensorFlow backend.
WARNING: Logging before flag parsing goes to stderr.
W0618 04:35:50.386720 140414143248192 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:74: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

W0618 04:35:50.393528 140414143248192 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:517: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

W0618 04:35:50.394327 140414143248192 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:4138: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

W0618 04:35:50.403112 140414143248192 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:133: The name tf.placeholder_with_default is deprecated. Please use tf.compat.v1.placeholder_with_default instead.

W0618 04:35:50.406336 140414143248192 deprecation.py:506] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0618 04:35:51.757727 140414143248192 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/optimizers.py:790: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.

W0618 04:35:51.768951 140414143248192 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3295: The name tf.log is deprecated. Please use tf.math.log instead.

W0618 04:35:51.864112 140414143248192 deprecation.py:323] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/tensorflow/python/ops/math_grad.py:1250: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-18 04:35:54.283361: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2020-06-18 04:35:54.305941: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3696000000 Hz
2020-06-18 04:35:54.306650: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5623400a7060 executing computations on platform Host. Devices:
2020-06-18 04:35:54.306682: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): <undefined>, <undefined>
2020-06-18 04:35:54.307280: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcuda.so.1
2020-06-18 04:35:54.323056: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:35:54.323825: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.6325
pciBusID: 0000:01:00.0
2020-06-18 04:35:54.323967: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-06-18 04:35:54.324878: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
2020-06-18 04:35:54.325835: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcufft.so.10
2020-06-18 04:35:54.326004: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcurand.so.10
2020-06-18 04:35:54.326904: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusolver.so.10
2020-06-18 04:35:54.327435: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusparse.so.10
2020-06-18 04:35:54.329544: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7
2020-06-18 04:35:54.329644: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:35:54.330215: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:35:54.330712: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0
2020-06-18 04:35:54.330751: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-06-18 04:35:54.380943: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-06-18 04:35:54.380969: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1187]      0 
2020-06-18 04:35:54.380975: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 0:   N 
2020-06-18 04:35:54.381259: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:35:54.381785: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:35:54.382216: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:35:54.382638: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10388 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)
2020-06-18 04:35:54.383636: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5623479f4860 executing computations on platform CUDA. Devices:
2020-06-18 04:35:54.383648: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): GeForce GTX 1080 Ti, Compute Capability 6.1
2020-06-18 04:35:57.206095: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
>>>OSA<<<
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, 150, 128)          64000     
_________________________________________________________________
spatial_dropout1d_1 (Spatial (None, 150, 128)          0         
_________________________________________________________________
lstm_1 (LSTM)                (None, 150, 500)          1258000   
_________________________________________________________________
lstm_2 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_3 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_4 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_5 (LSTM)                (None, 500)               2002000   
_________________________________________________________________
dense_1 (Dense)              (None, 4)                 2004      
=================================================================
Total params: 9,332,004
Trainable params: 9,332,004
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/50
 - 9s - loss: 1.4359 - acc: 0.2612
Epoch 2/50
 - 4s - loss: 1.3939 - acc: 0.9194
Epoch 3/50
 - 4s - loss: 1.0151 - acc: 0.9194
Epoch 4/50
 - 4s - loss: 1.8156 - acc: 0.9194
Epoch 5/50
 - 4s - loss: 0.6393 - acc: 0.9194
Epoch 6/50
 - 4s - loss: 1.1846 - acc: 0.0791
Epoch 7/50
 - 4s - loss: 0.8094 - acc: 0.6119
Epoch 8/50
 - 4s - loss: 0.7567 - acc: 0.9194
Epoch 9/50
 - 4s - loss: 0.6374 - acc: 0.9194
Epoch 10/50
 - 4s - loss: 0.6148 - acc: 0.9194
Epoch 11/50
 - 4s - loss: 0.6435 - acc: 0.9194
Epoch 12/50
 - 4s - loss: 0.6508 - acc: 0.9194
Epoch 13/50
 - 4s - loss: 0.6342 - acc: 0.9194
Epoch 14/50
 - 4s - loss: 0.6092 - acc: 0.9194
Epoch 15/50
 - 4s - loss: 0.5997 - acc: 0.9194
Epoch 16/50
 - 4s - loss: 0.6095 - acc: 0.9194
Epoch 17/50
 - 4s - loss: 0.6243 - acc: 0.9194
/home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/callbacks.py:434: RuntimeWarning: Can save best model only with val_loss available, skipping.
  'skipping.' % (self.monitor), RuntimeWarning)
Using TensorFlow backend.
Akurasi:  0.5833333333333334
Using TensorFlow backend.
WARNING: Logging before flag parsing goes to stderr.
W0618 04:37:09.412837 139774686218048 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:74: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

W0618 04:37:09.419737 139774686218048 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:517: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

W0618 04:37:09.420521 139774686218048 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:4138: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

W0618 04:37:09.429319 139774686218048 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:133: The name tf.placeholder_with_default is deprecated. Please use tf.compat.v1.placeholder_with_default instead.

W0618 04:37:09.432597 139774686218048 deprecation.py:506] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0618 04:37:10.756372 139774686218048 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/optimizers.py:790: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.

W0618 04:37:10.767862 139774686218048 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3295: The name tf.log is deprecated. Please use tf.math.log instead.

W0618 04:37:10.864570 139774686218048 deprecation.py:323] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/tensorflow/python/ops/math_grad.py:1250: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-18 04:37:13.314801: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2020-06-18 04:37:13.337958: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3696000000 Hz
2020-06-18 04:37:13.338686: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55a98b1b7b60 executing computations on platform Host. Devices:
2020-06-18 04:37:13.338700: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): <undefined>, <undefined>
2020-06-18 04:37:13.339464: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcuda.so.1
2020-06-18 04:37:13.355540: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:37:13.356269: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.6325
pciBusID: 0000:01:00.0
2020-06-18 04:37:13.356388: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-06-18 04:37:13.357408: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
2020-06-18 04:37:13.358420: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcufft.so.10
2020-06-18 04:37:13.358569: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcurand.so.10
2020-06-18 04:37:13.359628: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusolver.so.10
2020-06-18 04:37:13.360183: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusparse.so.10
2020-06-18 04:37:13.362660: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7
2020-06-18 04:37:13.362740: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:37:13.363488: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:37:13.364197: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0
2020-06-18 04:37:13.364221: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-06-18 04:37:13.415849: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-06-18 04:37:13.415874: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1187]      0 
2020-06-18 04:37:13.415879: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 0:   N 
2020-06-18 04:37:13.416165: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:37:13.416605: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:37:13.417121: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:37:13.417536: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10388 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)
2020-06-18 04:37:13.418476: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55a992b32e90 executing computations on platform CUDA. Devices:
2020-06-18 04:37:13.418488: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): GeForce GTX 1080 Ti, Compute Capability 6.1
2020-06-18 04:37:16.254235: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
>>>Asthma<<<
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, 150, 128)          64000     
_________________________________________________________________
spatial_dropout1d_1 (Spatial (None, 150, 128)          0         
_________________________________________________________________
lstm_1 (LSTM)                (None, 150, 500)          1258000   
_________________________________________________________________
lstm_2 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_3 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_4 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_5 (LSTM)                (None, 500)               2002000   
_________________________________________________________________
dense_1 (Dense)              (None, 4)                 2004      
=================================================================
Total params: 9,332,004
Trainable params: 9,332,004
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/50
 - 9s - loss: 1.2475 - acc: 0.2507
Epoch 2/50
 - 4s - loss: 1.2151 - acc: 0.8254
Epoch 3/50
 - 4s - loss: 0.9346 - acc: 0.8254
Epoch 4/50
 - 4s - loss: 1.2383 - acc: 0.8254
Epoch 5/50
 - 3s - loss: 0.9676 - acc: 0.1731
Epoch 6/50
 - 3s - loss: 0.6496 - acc: 0.2358
Epoch 7/50
 - 4s - loss: 0.6117 - acc: 0.8254
Epoch 8/50
 - 3s - loss: 0.6501 - acc: 0.8254
Epoch 9/50
 - 4s - loss: 0.6507 - acc: 0.8254
Epoch 10/50
 - 4s - loss: 0.6324 - acc: 0.8254
Epoch 11/50
 - 3s - loss: 0.6230 - acc: 0.8254
Epoch 12/50
 - 3s - loss: 0.6136 - acc: 0.8254
Epoch 13/50
 - 3s - loss: 0.6045 - acc: 0.8254
Epoch 14/50
 - 4s - loss: 0.6059 - acc: 0.8254
Epoch 15/50
 - 4s - loss: 0.6079 - acc: 0.8254
Epoch 16/50
 - 3s - loss: 0.6036 - acc: 0.8254
Epoch 17/50
 - 3s - loss: 0.6033 - acc: 0.8254
/home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/callbacks.py:434: RuntimeWarning: Can save best model only with val_loss available, skipping.
  'skipping.' % (self.monitor), RuntimeWarning)
Using TensorFlow backend.
Akurasi:  0.4107142857142857
Using TensorFlow backend.
WARNING: Logging before flag parsing goes to stderr.
W0618 04:38:27.175937 140028409382720 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:74: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

W0618 04:38:27.182760 140028409382720 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:517: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

W0618 04:38:27.183510 140028409382720 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:4138: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

W0618 04:38:27.192404 140028409382720 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:133: The name tf.placeholder_with_default is deprecated. Please use tf.compat.v1.placeholder_with_default instead.

W0618 04:38:27.195651 140028409382720 deprecation.py:506] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0618 04:38:28.525426 140028409382720 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/optimizers.py:790: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.

W0618 04:38:28.536764 140028409382720 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3295: The name tf.log is deprecated. Please use tf.math.log instead.

W0618 04:38:28.633007 140028409382720 deprecation.py:323] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/tensorflow/python/ops/math_grad.py:1250: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-18 04:38:31.068350: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2020-06-18 04:38:31.089921: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3696000000 Hz
2020-06-18 04:38:31.090633: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5583a80aa060 executing computations on platform Host. Devices:
2020-06-18 04:38:31.090647: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): <undefined>, <undefined>
2020-06-18 04:38:31.091437: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcuda.so.1
2020-06-18 04:38:31.107177: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:38:31.107938: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.6325
pciBusID: 0000:01:00.0
2020-06-18 04:38:31.108082: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-06-18 04:38:31.109122: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
2020-06-18 04:38:31.110162: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcufft.so.10
2020-06-18 04:38:31.110345: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcurand.so.10
2020-06-18 04:38:31.111455: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusolver.so.10
2020-06-18 04:38:31.112039: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusparse.so.10
2020-06-18 04:38:31.114356: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7
2020-06-18 04:38:31.114460: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:38:31.115229: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:38:31.115832: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0
2020-06-18 04:38:31.115870: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-06-18 04:38:31.168448: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-06-18 04:38:31.168476: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1187]      0 
2020-06-18 04:38:31.168482: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 0:   N 
2020-06-18 04:38:31.168774: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:38:31.169226: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:38:31.169667: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:38:31.170092: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10388 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)
2020-06-18 04:38:31.171089: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5583af9f68a0 executing computations on platform CUDA. Devices:
2020-06-18 04:38:31.171101: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): GeForce GTX 1080 Ti, Compute Capability 6.1
2020-06-18 04:38:34.029226: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
>>>Gerd<<<
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, 150, 128)          64000     
_________________________________________________________________
spatial_dropout1d_1 (Spatial (None, 150, 128)          0         
_________________________________________________________________
lstm_1 (LSTM)                (None, 150, 500)          1258000   
_________________________________________________________________
lstm_2 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_3 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_4 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_5 (LSTM)                (None, 500)               2002000   
_________________________________________________________________
dense_1 (Dense)              (None, 4)                 2004      
=================================================================
Total params: 9,332,004
Trainable params: 9,332,004
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/50
 - 9s - loss: 1.3449 - acc: 0.2313
Epoch 2/50
 - 4s - loss: 1.3017 - acc: 0.8433
Epoch 3/50
 - 4s - loss: 0.9032 - acc: 0.8433
Epoch 4/50
 - 4s - loss: 1.0899 - acc: 0.8433
Epoch 5/50
 - 4s - loss: 0.5589 - acc: 0.8433
Epoch 6/50
 - 4s - loss: 0.4679 - acc: 0.8433
Epoch 7/50
 - 4s - loss: 0.4787 - acc: 0.8433
Epoch 8/50
 - 4s - loss: 0.4047 - acc: 0.8433
Epoch 9/50
 - 4s - loss: 0.3829 - acc: 0.8433
Epoch 10/50
 - 4s - loss: 0.3990 - acc: 0.8433
Epoch 11/50
 - 4s - loss: 0.4082 - acc: 0.8433
Epoch 12/50
 - 3s - loss: 0.4016 - acc: 0.8433
Epoch 13/50
 - 4s - loss: 0.3862 - acc: 0.8433
Epoch 14/50
 - 3s - loss: 0.3773 - acc: 0.8433
Epoch 15/50
 - 4s - loss: 0.3878 - acc: 0.8433
Epoch 16/50
 - 3s - loss: 0.3955 - acc: 0.8433
Epoch 17/50
 - 4s - loss: 0.3852 - acc: 0.8433
/home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/callbacks.py:434: RuntimeWarning: Can save best model only with val_loss available, skipping.
  'skipping.' % (self.monitor), RuntimeWarning)
Using TensorFlow backend.
Akurasi:  0.8214285714285714
Using TensorFlow backend.
WARNING: Logging before flag parsing goes to stderr.
W0618 04:39:45.909869 140240533649216 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:74: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

W0618 04:39:45.916691 140240533649216 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:517: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

W0618 04:39:45.917470 140240533649216 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:4138: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

W0618 04:39:45.926521 140240533649216 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:133: The name tf.placeholder_with_default is deprecated. Please use tf.compat.v1.placeholder_with_default instead.

W0618 04:39:45.929836 140240533649216 deprecation.py:506] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0618 04:39:47.250383 140240533649216 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/optimizers.py:790: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.

W0618 04:39:47.261800 140240533649216 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3295: The name tf.log is deprecated. Please use tf.math.log instead.

W0618 04:39:47.357445 140240533649216 deprecation.py:323] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/tensorflow/python/ops/math_grad.py:1250: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-18 04:39:49.789647: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2020-06-18 04:39:49.813973: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3696000000 Hz
2020-06-18 04:39:49.814831: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5606948d7b60 executing computations on platform Host. Devices:
2020-06-18 04:39:49.814855: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): <undefined>, <undefined>
2020-06-18 04:39:49.815438: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcuda.so.1
2020-06-18 04:39:49.831122: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:39:49.831857: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.6325
pciBusID: 0000:01:00.0
2020-06-18 04:39:49.831979: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-06-18 04:39:49.833065: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
2020-06-18 04:39:49.834102: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcufft.so.10
2020-06-18 04:39:49.834264: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcurand.so.10
2020-06-18 04:39:49.835426: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusolver.so.10
2020-06-18 04:39:49.836066: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusparse.so.10
2020-06-18 04:39:49.838588: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7
2020-06-18 04:39:49.838669: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:39:49.839427: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:39:49.840132: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0
2020-06-18 04:39:49.840160: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-06-18 04:39:49.893122: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-06-18 04:39:49.893148: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1187]      0 
2020-06-18 04:39:49.893156: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 0:   N 
2020-06-18 04:39:49.893452: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:39:49.893922: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:39:49.894365: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:39:49.894836: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10388 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)
2020-06-18 04:39:49.895853: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56069c252e20 executing computations on platform CUDA. Devices:
2020-06-18 04:39:49.895866: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): GeForce GTX 1080 Ti, Compute Capability 6.1
2020-06-18 04:39:52.745056: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
>>>Gallstone<<<
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, 150, 128)          64000     
_________________________________________________________________
spatial_dropout1d_1 (Spatial (None, 150, 128)          0         
_________________________________________________________________
lstm_1 (LSTM)                (None, 150, 500)          1258000   
_________________________________________________________________
lstm_2 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_3 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_4 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_5 (LSTM)                (None, 500)               2002000   
_________________________________________________________________
dense_1 (Dense)              (None, 4)                 2004      
=================================================================
Total params: 9,332,004
Trainable params: 9,332,004
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/50
 - 9s - loss: 1.2953 - acc: 0.2567
Epoch 2/50
 - 3s - loss: 1.2599 - acc: 0.7463
Epoch 3/50
 - 3s - loss: 0.9531 - acc: 0.7463
Epoch 4/50
 - 3s - loss: 1.5091 - acc: 0.7463
Epoch 5/50
 - 4s - loss: 0.5529 - acc: 0.7463
Epoch 6/50
 - 3s - loss: 0.7247 - acc: 0.7463
Epoch 7/50
 - 4s - loss: 0.7353 - acc: 0.3373
Epoch 8/50
 - 4s - loss: 0.6154 - acc: 0.7463
Epoch 9/50
 - 4s - loss: 0.4920 - acc: 0.7463
Epoch 10/50
 - 3s - loss: 0.4854 - acc: 0.7463
Epoch 11/50
 - 4s - loss: 0.5244 - acc: 0.7463
Epoch 12/50
 - 3s - loss: 0.5279 - acc: 0.7463
Epoch 13/50
 - 4s - loss: 0.4987 - acc: 0.7463
Epoch 14/50
 - 3s - loss: 0.4730 - acc: 0.7463
Epoch 15/50
 - 3s - loss: 0.4850 - acc: 0.7463
Epoch 16/50
 - 3s - loss: 0.5048 - acc: 0.7463
Epoch 17/50
 - 4s - loss: 0.4869 - acc: 0.7463
/home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/callbacks.py:434: RuntimeWarning: Can save best model only with val_loss available, skipping.
  'skipping.' % (self.monitor), RuntimeWarning)
Using TensorFlow backend.
Akurasi:  0.7738095238095238
Using TensorFlow backend.
WARNING: Logging before flag parsing goes to stderr.
W0618 04:41:04.107544 140696938305344 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:74: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

W0618 04:41:04.114406 140696938305344 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:517: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

W0618 04:41:04.115173 140696938305344 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:4138: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

W0618 04:41:04.124179 140696938305344 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:133: The name tf.placeholder_with_default is deprecated. Please use tf.compat.v1.placeholder_with_default instead.

W0618 04:41:04.127503 140696938305344 deprecation.py:506] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0618 04:41:05.439507 140696938305344 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/optimizers.py:790: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.

W0618 04:41:05.450660 140696938305344 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3295: The name tf.log is deprecated. Please use tf.math.log instead.

W0618 04:41:05.543845 140696938305344 deprecation.py:323] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/tensorflow/python/ops/math_grad.py:1250: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-18 04:41:07.925776: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2020-06-18 04:41:07.949944: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3696000000 Hz
2020-06-18 04:41:07.950654: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d32de33be0 executing computations on platform Host. Devices:
2020-06-18 04:41:07.950695: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): <undefined>, <undefined>
2020-06-18 04:41:07.951310: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcuda.so.1
2020-06-18 04:41:07.967255: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:41:07.968028: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.6325
pciBusID: 0000:01:00.0
2020-06-18 04:41:07.968193: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-06-18 04:41:07.969243: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
2020-06-18 04:41:07.970324: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcufft.so.10
2020-06-18 04:41:07.970506: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcurand.so.10
2020-06-18 04:41:07.971692: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusolver.so.10
2020-06-18 04:41:07.972359: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusparse.so.10
2020-06-18 04:41:07.974813: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7
2020-06-18 04:41:07.974917: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:41:07.975582: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:41:07.976295: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0
2020-06-18 04:41:07.976339: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-06-18 04:41:08.028667: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-06-18 04:41:08.028693: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1187]      0 
2020-06-18 04:41:08.028703: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 0:   N 
2020-06-18 04:41:08.028990: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:41:08.029547: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:41:08.030031: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:41:08.030507: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10388 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)
2020-06-18 04:41:08.031529: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d331a517a0 executing computations on platform CUDA. Devices:
2020-06-18 04:41:08.031541: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): GeForce GTX 1080 Ti, Compute Capability 6.1
2020-06-18 04:41:10.894339: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
>>>Depression<<<
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, 150, 128)          64000     
_________________________________________________________________
spatial_dropout1d_1 (Spatial (None, 150, 128)          0         
_________________________________________________________________
lstm_1 (LSTM)                (None, 150, 500)          1258000   
_________________________________________________________________
lstm_2 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_3 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_4 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_5 (LSTM)                (None, 500)               2002000   
_________________________________________________________________
dense_1 (Dense)              (None, 4)                 2004      
=================================================================
Total params: 9,332,004
Trainable params: 9,332,004
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/50
 - 9s - loss: 1.2931 - acc: 0.2731
Epoch 2/50
 - 4s - loss: 1.2550 - acc: 0.8299
Epoch 3/50
 - 4s - loss: 0.9153 - acc: 0.8299
Epoch 4/50
 - 4s - loss: 0.8058 - acc: 0.8299
Epoch 5/50
 - 4s - loss: 0.4711 - acc: 0.8299
Epoch 6/50
 - 4s - loss: 0.4092 - acc: 0.8299
Epoch 7/50
 - 4s - loss: 0.4059 - acc: 0.8299
Epoch 8/50
 - 3s - loss: 0.3500 - acc: 0.8299
Epoch 9/50
 - 3s - loss: 0.3478 - acc: 0.8299
Epoch 10/50
 - 4s - loss: 0.3616 - acc: 0.8299
Epoch 11/50
 - 4s - loss: 0.3672 - acc: 0.8299
Epoch 12/50
 - 4s - loss: 0.3602 - acc: 0.8299
Epoch 13/50
 - 4s - loss: 0.3500 - acc: 0.8299
Epoch 14/50
 - 4s - loss: 0.3408 - acc: 0.8299
Epoch 15/50
 - 4s - loss: 0.3439 - acc: 0.8299
Epoch 16/50
 - 4s - loss: 0.3486 - acc: 0.8299
Epoch 17/50
 - 4s - loss: 0.3525 - acc: 0.8299
/home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/callbacks.py:434: RuntimeWarning: Can save best model only with val_loss available, skipping.
  'skipping.' % (self.monitor), RuntimeWarning)
Using TensorFlow backend.
Akurasi:  0.8392857142857143
Using TensorFlow backend.
WARNING: Logging before flag parsing goes to stderr.
W0618 04:42:22.963935 139713779726144 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:74: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

W0618 04:42:22.970717 139713779726144 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:517: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

W0618 04:42:22.971485 139713779726144 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:4138: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

W0618 04:42:22.980479 139713779726144 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:133: The name tf.placeholder_with_default is deprecated. Please use tf.compat.v1.placeholder_with_default instead.

W0618 04:42:22.983795 139713779726144 deprecation.py:506] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0618 04:42:24.298398 139713779726144 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/optimizers.py:790: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.

W0618 04:42:24.309640 139713779726144 deprecation_wrapper.py:119] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3295: The name tf.log is deprecated. Please use tf.math.log instead.

W0618 04:42:24.404433 139713779726144 deprecation.py:323] From /home/herley/.conda/envs/herley/lib/python3.7/site-packages/tensorflow/python/ops/math_grad.py:1250: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-18 04:42:26.805114: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2020-06-18 04:42:26.825942: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3696000000 Hz
2020-06-18 04:42:26.826453: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55a9737585e0 executing computations on platform Host. Devices:
2020-06-18 04:42:26.826470: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): <undefined>, <undefined>
2020-06-18 04:42:26.827101: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcuda.so.1
2020-06-18 04:42:26.843011: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:42:26.843774: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.6325
pciBusID: 0000:01:00.0
2020-06-18 04:42:26.843916: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-06-18 04:42:26.844827: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
2020-06-18 04:42:26.845779: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcufft.so.10
2020-06-18 04:42:26.845952: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcurand.so.10
2020-06-18 04:42:26.846931: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusolver.so.10
2020-06-18 04:42:26.847398: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusparse.so.10
2020-06-18 04:42:26.849463: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7
2020-06-18 04:42:26.849528: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:42:26.850327: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:42:26.851033: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0
2020-06-18 04:42:26.851058: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-06-18 04:42:26.901602: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-06-18 04:42:26.901626: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1187]      0 
2020-06-18 04:42:26.901647: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 0:   N 
2020-06-18 04:42:26.901951: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:42:26.902396: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:42:26.902828: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-06-18 04:42:26.903244: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10388 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)
2020-06-18 04:42:26.904238: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55a97b0a70c0 executing computations on platform CUDA. Devices:
2020-06-18 04:42:26.904249: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): GeForce GTX 1080 Ti, Compute Capability 6.1
2020-06-18 04:42:29.748295: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
>>>Gout<<<
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, 150, 128)          64000     
_________________________________________________________________
spatial_dropout1d_1 (Spatial (None, 150, 128)          0         
_________________________________________________________________
lstm_1 (LSTM)                (None, 150, 500)          1258000   
_________________________________________________________________
lstm_2 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_3 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_4 (LSTM)                (None, 150, 500)          2002000   
_________________________________________________________________
lstm_5 (LSTM)                (None, 500)               2002000   
_________________________________________________________________
dense_1 (Dense)              (None, 4)                 2004      
=================================================================
Total params: 9,332,004
Trainable params: 9,332,004
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/50
 - 9s - loss: 1.1649 - acc: 0.2493
Epoch 2/50
 - 4s - loss: 1.1383 - acc: 0.4493
Epoch 3/50
 - 4s - loss: 0.9344 - acc: 0.4224
Epoch 4/50
 - 4s - loss: 0.5826 - acc: 0.4537
Epoch 5/50
 - 4s - loss: 0.8409 - acc: 0.4433
Epoch 6/50
 - 4s - loss: 1.4059 - acc: 0.3970
Epoch 7/50
 - 4s - loss: 0.8192 - acc: 0.3970
Epoch 8/50
 - 4s - loss: 0.6400 - acc: 0.4433
Epoch 9/50
 - 4s - loss: 0.8247 - acc: 0.4433
Epoch 10/50
 - 4s - loss: 0.7291 - acc: 0.4433
Epoch 11/50
 - 4s - loss: 0.5896 - acc: 0.4433
Epoch 12/50
 - 4s - loss: 0.6269 - acc: 0.3970
Epoch 13/50
 - 4s - loss: 0.7001 - acc: 0.3970
Epoch 14/50
 - 4s - loss: 0.6706 - acc: 0.3970
Epoch 15/50
 - 4s - loss: 0.6045 - acc: 0.3970
Epoch 16/50
 - 4s - loss: 0.5841 - acc: 0.4433
Epoch 17/50
 - 4s - loss: 0.6206 - acc: 0.4433
Epoch 18/50
 - 4s - loss: 0.6440 - acc: 0.4433
Epoch 19/50
 - 4s - loss: 0.6289 - acc: 0.4433
/home/herley/.conda/envs/herley/lib/python3.7/site-packages/keras/callbacks.py:434: RuntimeWarning: Can save best model only with val_loss available, skipping.
  'skipping.' % (self.monitor), RuntimeWarning)
Using TensorFlow backend.
Akurasi:  0.38095238095238093
